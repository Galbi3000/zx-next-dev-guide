\documentclass[12pt,twoside,openright,a4paper]{book}

\usepackage{fancyhdr}
\usepackage{a4wide}
\usepackage{afterpage}
\usepackage{amsfonts}
\usepackage{url}
\usepackage{array}
\usepackage{multicol}
\usepackage{multirow}
\usepackage{parcolumns}
\usepackage{enumitem}
\usepackage{etoolbox}
\usepackage{mdwlist}
\usepackage{minitoc}
\usepackage{environ}
\usepackage{tabularx}
\usepackage{mathabx}
\usepackage{numprint}
\usepackage{bigdelim}
\usepackage{xfp}
\usepackage{xurl}
\usepackage{xstring}
\usepackage{xparse}
\usepackage[table]{xcolor}
\usepackage[nottoc,numbib]{tocbibind}
\usepackage[xparse,breakable,skins,listings]{tcolorbox}
\usepackage{tikz}
\usepackage[
	a4paper,
	layout=a4paper,
	bindingoffset=0.25cm,	% offset pages to accomodate for binding
	width=17cm,				% this matches original LaTeX width, geometry makes it narrower by default
	top=3cm,				% reduce top edge, too big on default settings
	bottom=2.5cm			% page numbers should be much lower on the page
]{geometry}

\usetikzlibrary{matrix,fit,positioning,calc,arrows.meta}

% ASCII text created with https://fsymbols.com/generators/carty/
% in case it's not obvious - these large titles are nicely visible in minimap¯\_(ツ)_/¯

% include definitions from external files.
\input{defines.tex}
\input{tables.tex}
\input{instructions.tex}


\begin{document}

% use arabic numerals for starting pages
\frontmatter

% note: includes cannot be nested, therefore we must include each section separately (where chapters are divided into multiple files)

\include{chapter-title.tex}

% all other pages after this one should use defaults from `usepackage' statement on the top of the file!
\afterpage{\aftergroup\restoregeometry}

\include{chapter-copyright.tex}

% use arabic numerals for page numbers and clean page style for the rest of the document
\mainmatter

\include{chapter-introduction.tex}

\include{chapter-z80.tex}

\include{chapter-next.tex}
\include{chapter-next-ports.tex}
\include{chapter-next-memory.tex}
\include{chapter-next-ula.tex}
\include{chapter-next-layer2.tex}
\include{chapter-next-tilemap.tex}
\include{chapter-next-sprites.tex}
\include{chapter-next-sound.tex}
\include{chapter-next-keyboard.tex}
\include{chapter-next-interrupts.tex}

\include{chapter-instr-glance.tex}

\include{chapter-instr-close.tex}

\appendix

% only print chapters in appendices, not sections and subsections
\addtocontents{toc}{\protect\setcounter{tocdepth}{0}}

\include{chapter-instr-sorted-mnemonic.tex}
\include{chapter-instr-sorted-opcode.tex}
\include{chapter-bibliography.tex}
\include{chapter-license.tex}

\end{document}
