\documentclass[12pt,twoside,openright,a4paper]{book}

\usepackage{fancyhdr}
\usepackage{a4wide}
\usepackage{etoc}
\usepackage{afterpage}
\usepackage{amsfonts}
\usepackage{anyfontsize}
\usepackage{url}
\usepackage{array}
\usepackage{multicol}
\usepackage{multirow}
\usepackage{parcolumns}
\usepackage{enumitem}
\usepackage{etoolbox}
\usepackage{mdwlist}
\usepackage{tabularx}
\usepackage{mathabx}
\usepackage{numprint}
\usepackage{bigdelim}
\usepackage{hhline}
\usepackage{xfp}
\usepackage{xstring}
\usepackage{xparse}
\usepackage[table]{xcolor}
\usepackage[bottom]{footmisc}
\usepackage[nottoc,numbib]{tocbibind}
\usepackage[xparse,breakable,skins,listings]{tcolorbox}
\usepackage{hyperref}
\usepackage{microtype}
\usepackage{tikz}
\usepackage[
	a4paper,
	layout=a4paper,
	bindingoffset=0.25cm,	% offset pages to accomodate for binding
	width=17cm,				% this matches original LaTeX width, geometry makes it narrower by default
	top=3cm,				% reduce top edge, too big on default settings
	bottom=2.5cm			% page numbers should be much lower on the page
]{geometry}

% include definitions from external files (note: order of inputs is important!)
\input{defines.tex}
\input{setup.tex}
\input{tables.tex}
\input{instructions.tex}


% ASCII text created with https://fsymbols.com/generators/carty/
% in case it's not obvious - these large titles are nicely visible in minimap¯\_(ツ)_/¯

\begin{document}

	% note: includes cannot be nested, therefore we must include each section separately (where chapters are divided into multiple files)

	% ▒█▀▀▀ ▒█▀▀█ ▒█▀▀▀█ ▒█▄░▒█ ▀▀█▀▀ 
	% ▒█▀▀▀ ▒█▄▄▀ ▒█░░▒█ ▒█▒█▒█ ░▒█░░ 
	% ▒█░░░ ▒█░▒█ ▒█▄▄▄█ ▒█░░▀█ ░▒█░░

	\SetupPageFormattingTitle

	\include{chapter-title.tex}

	\SetupPageFormattingIntro
	
	\include{chapter-copyright.tex}
	\include{chapter-acknowledge.tex}

	\SetupPageFormattingTOC

	\include{chapter-toc.tex}


	% ▒█▀▀█ ▒█▀▀▀█ ▒█▄░▒█ ▀▀█▀▀ ▒█▀▀▀ ▒█▄░▒█ ▀▀█▀▀ 
	% ▒█░░░ ▒█░░▒█ ▒█▒█▒█ ░▒█░░ ▒█▀▀▀ ▒█▒█▒█ ░▒█░░ 
	% ▒█▄▄█ ▒█▄▄▄█ ▒█░░▀█ ░▒█░░ ▒█▄▄▄ ▒█░░▀█ ░▒█░░

	\SetupPageFormattingBook

	\include{chapter-introduction.tex}

	\include{chapter-z80.tex}

	\include{chapter-next.tex}
	\include{chapter-next-ports.tex}
	\include{chapter-next-memory.tex}
	\include{chapter-next-dma.tex}
	\include{chapter-next-palette.tex}
	\include{chapter-next-ula.tex}
	\include{chapter-next-layer2.tex}
	\include{chapter-next-tilemap.tex}
	\include{chapter-next-sprites.tex}
	\include{chapter-next-copper.tex}
	\include{chapter-next-sound.tex}
	\include{chapter-next-keyboard.tex}
	\include{chapter-next-interrupts.tex}

	\SetupPageFormattingInstructions

	% note: we are using input instead of include here, include will insert empty pages as it treats each file as its own section.
	\include{chapter-instr-glance.tex}
	\input{chapter-instr-glance-8bit-arithmetic.tex}
	\input{chapter-instr-glance-16bit-arithmetic.tex}
	\input{chapter-instr-glance-8bit-load.tex}
	\input{chapter-instr-glance-general.tex}
	\input{chapter-instr-glance-16bit-load.tex}
	\input{chapter-instr-glance-stack.tex}
	\input{chapter-instr-glance-exchange.tex}
	\input{chapter-instr-glance-bit.tex}
	\input{chapter-instr-glance-rotate-shift.tex}
	\input{chapter-instr-glance-jump.tex}
	\input{chapter-instr-glance-call-return.tex}
	\input{chapter-instr-glance-block.tex}
	\input{chapter-instr-glance-input.tex}
	\input{chapter-instr-glance-output.tex}
	\input{chapter-instr-glance-next.tex}
	\input{chapter-instr-glance-alphabetical.tex}

	\include{chapter-instr-close.tex}


	% ░█▀▀█ ▒█▀▀█ ▒█▀▀█ ▒█▀▀▀ ▒█▄░▒█ ▒█▀▀▄ ▀█▀ ▀▄▒▄▀ 
	% ▒█▄▄█ ▒█▄▄█ ▒█▄▄█ ▒█▀▀▀ ▒█▒█▒█ ▒█░▒█ ▒█░ ░▒█░░ 
	% ▒█░▒█ ▒█░░░ ▒█░░░ ▒█▄▄▄ ▒█░░▀█ ▒█▄▄▀ ▄█▄ ▄▀▒▀▄

	\SetupPageFormattingAppendix

	\include{chapter-instr-sorted-mnemonic.tex}
	\include{chapter-instr-sorted-opcode.tex}
	\include{chapter-bibliography.tex}
	\include{chapter-license.tex}

\end{document}
